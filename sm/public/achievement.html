<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" href="stylesheets/index.css">
		<link rel="stylesheet" href="font_ps99atp86ak/iconfont.css">
		<style type="text/css">
			#tops p {
				height: 60px;
				line-height: 60px;
				font-size: 26px;
				font-family: bold;
				background-color: #20b6ad;
				color: #fff;
				margin-bottom: 20px;
			}
			#tops p a {
				text-decoration: none;
				float: left;
				margin-left: 5%;
				margin-right: 15px;
				line-height: 60px;
			}

			#tops a i {
				color: #fff;

			}
		</style>
	</head>
	<body>
		<div id="tops">
			<p>
				<a href="index.html"><i class="iconfont"></i></a>
				学生成绩录入
			</p>
		</div>
		<div id="achievement">
			<table border="1" class="one" cellspacing="0" cellpadding="0">
				<tr>
					<th>班级</th>
					<th>学号</th>
					<th>姓名</th>
					<th>月考成绩</th>
					<th>周考成绩</th>
					<th>是否通过</th>
				</tr>
				<tr>
					<td style="width:10%;">
						<select class="z-text" id="class_ban" style="width:100%;height:100%;font-size:18px;border: none;">

						</select>
					</td>
					<td><input type="text" id="stu_number" placeholder="学员学号"></td>
					<td><input type="text" id="stu_name" placeholder="学员姓名"></td>
					<td>
						<table border="0" cellspacing="" cellpadding="">
							<tr>
								<td style="border-right:1px solid #2cc9aa;"><input type="text" id="written" placeholder="笔试成绩"></td>
								<td style="border-right:1px solid #2cc9aa;"><input type="text" id="machine" placeholder="机试成绩"></td>
								<td><input type="text" id="Interview" placeholder="面试成绩"></td>
							</tr>
						</table>
					</td>
					<td>
						<table border="0" style="border:1px solid #2cc9aa;" cellspacing="" cellpadding="">
							<tr>
								<td style="border-right:1px solid #2cc9aa;"><input type="text" id="zhouone" placeholder="周考一成绩"></td>
								<td style="border-right:1px solid #2cc9aa;"><input type="text" id="zhoutwo" placeholder="周考二成绩"></td>
								<td><input type="text" id="thouthree" placeholder="周考三成绩"></td>
							</tr>
						</table>
					</td>
					<td style="width: 13%;text-align: center;">
						<select class="z-text" id="gender" style="width:100%;height:100%;font-size:18px;border: none;">
							<option value="通过">通过</option>
							<option value="否">否</option>
						</select>
					</td>
				</tr>
			</table>
			<div class="operation">
				<button id="Submitment">提交</button>
			</div>
		</div>
		</div>
	</body>
	<script src="font_ps99atp86ak/iconfont.js"></script>
	<script src="js/jquery.js"></script>
	<script>
		var ali = document.querySelectorAll('#e>li')
		console.log(ali)
		for (var i = 0; i < ali.length; i++) {
			ali[i].index = i;
			ali[i].onclick = function() {
				for (var i = 0; i < ali.length; i++) {
					ali[i].className = '';
				}
				ali[this.index].className = 'active';
			}
		}
		//请求后台有班级阶段
		window.onload = function() {
			read()
		}

		function read() {
			$.ajax({
				type: 'get',
				url: 'http://localhost:8000/indexs/Read_class',
				success(data) {
					var str = '';
					for (var i = 0; i < data.length; i++) {
						str += `
							<option value="${data[i].class}">${data[i].class}</option>
						`
					}
					class_ban.innerHTML = str
				}
			})
		}
		//学号失去焦点的时候发送请求判断当前班级是否存在改学员学号
		$('#class_ban').on('blur', function() {
			$("input").val('')
		})
		$('#stu_number').on('blur', function() {
			if (stu_number.value == '') {
				alert('请输入学员学号')
			}else{
				$.ajax({
					type:'get',
					url:'http://localhost:8000/indexs/stu_number',
					data: {
						stu: class_ban.value,
						stunum: stu_number.value
					},
					success(data) {
						console.log(data)
						if (data == '') {
							alert('未找到该学院')
						} else {
							stu_name.value = data[0].name;
						}
					}
				})
			}
		})
		//提交学员成绩
		$('#Submitment').on('click',function(){
			if(stu_number.value==''){
				alert('请输入学员学号')
			}else if(stu_name.value==''){
				alert('请输入学员姓名')
			}else if(written.value==''){
				alert('请输入学员笔试成绩')
			}else if(machine.value==''){
				alert('请输入学员计试成绩')
			}else if(Interview.value==''){
				alert('请输入学员面试成绩')
			}else if(zhouone.value==''){
				alert('请输入学员第一次周考成绩')
			}else if(zhoutwo.value==''){
				alert('请输入学员第二次周考成绩')
			}else if(thouthree.value==''){
				alert('请输入学员第三次周考成绩')
			}else if(gender.value==''){
				alert('请选择是否通过')
			}else{
				$.ajax({
					type:'get',
					url:'http://localhost:8000/indexs/Entry',
					data:{
						class_ban:class_ban.value,
						stu_number:stu_number.value,
						stu_name:stu_name.value,
						written:written.value,
						machine:machine.value,
						Interview:Interview.value,
						zhouone:zhouone.value,
						zhoutwo:zhoutwo.value,
						thouthree:thouthree.value,
						gender:gender.value
					},
					success(data){
						console.log(data)
						if(data=='ok'){
							$('input').val('');
						}else{
							alert('该学员成绩已被录入')
						}
					}
				})
			}
			
		})
	</script>
</html>
