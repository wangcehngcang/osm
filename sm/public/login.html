<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>登录/注册</title>
	<link rel="stylesheet" href="stylesheets/login.css">
</head>
<body>
	<div class="box">
		<div class="box_box">
			<!-- 登录 -->
			<div class="logon">
				<a href="index.html" id="gotoindex" class="fl">←</a>
				<h4>登录</h4>
				<div>账号：<input type="text" id="logon_user" placeholder="请输入账号"></div>
				<div>密码：<input type="password" id="logon_pass" placeholder="请输入密码"></div>
				<div class="a clearfix"><a href="#" class="fr" id="go_login">注册</a></div>
				<div><button id="logon_btn">登录</button></div>
				<main>
					<label class="fl"><input type="radio" name="id" value="男生" id="teacher">老师</label>
					<label class="fr"><input type="radio" name="id" value="女生" id="student">学生</label>
				</main>
			</div>
			<!-- 注册 -->
			<div class="login">
				<h4>注册</h4>
				<div>名字：<input type="text" id="login_name" placeholder="请输入昵称"></div>
				<div>账号：<input type="text" id="login_user" placeholder="请输入账号"></div>
				<div>密码：<input type="password" id="login_pass" placeholder="请输入密码"></div>
				<div><button id="gotologon">返回登陆</button> <button id="login_btn">注册</button></div>
			</div>
		</div>
	</div>
	<script src="js/jquery.js"></script>
	<script>
		var h = window.innerHeight;
		document.querySelector('.box').style.height=h+'px';
		$('#go_login').on('click',function(){
			$('.logon').css({
				'display':'none'
			})
			$('.login').css({
				'display':'block'
			})
		})
		$('#gotologon').on('click',function(){
				$('.logon').css({
					'display':'block'
				})
				$('.login').css({
					'display':'none'
				})
		})
		var href='http://localhost:8000';
		//注册
		login_btn.onclick=function(){
			if(/[\u4E00-\u9FA5]/g.test(login_user.value)||/[\u4E00-\u9FA5]/g.test(login_pass.value)){
				alert('账号或密码不得为中文')
			}else if(login_name.value==''){
				alert('请编辑昵称')
			}else if(login_user.value==''){
				alert('请输入账号')
			}else if(login_pass.value==''){
				alert('请输入密码')
			}else{
				$.ajax({
					type:'post',
					url:href+'/users/login',
					data:{
						name:login_name.value,
						user:login_user.value,
						pass:login_pass.value, 
					},
					success(data){
						if(data=='ok'){
							alert('注册成功');
							$('.login').css({'display':'none'})
							$('.logon').css({'display':'block'})
						}else{
							alert('该用户已被注册')
							login_name.value='';
							login_user.value='';
							login_pass.value='';
						}
					}
				})
			}
		}
		//登录	
		logon_btn.onclick=function(){
			if(/[\u4E00-\u9FA5]/g.test(logon_user.value)||/[\u4E00-\u9FA5]/g.test(logon_pass.value)){
				alert('内容不得为中文')
			}else if(logon_user.value==''){
				alert('请输入账号')
			}else if(logon_pass.value==''){
				alert('请输入密码')
			}else{
				$.ajax({
					type:'post',
					url:href+'/users/logon',
					data:{
						user:logon_user.value,
						pass:logon_pass.value,
					},
					success(data){
						console.log(data)
						if(data=='ok'){
							alert('账号或密码错误');
							logon_user.value='';
							pass_in.value='';
						}else{
							alert('登录成功');
							location.href='./index.html';
							localStorage.user = JSON.stringify(data)
						}
					}
				})
			}
		}
	</script>
</body>
</html>